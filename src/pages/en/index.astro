---
import Layout from '../../layouts/Layout.astro';
import TestCard from '../../components/TestCard.astro';
import ToolCard from '../../components/ToolCard.astro';
import { getTestMeta, categoryLabels } from '../../utils/tests';
import { getAllTools } from '../../utils/tools';
import { useTranslations } from '../../i18n';

const lang = 'en';
const t = useTranslations(lang);
const tests = getTestMeta(lang);
const tools = getAllTools(lang);
const categories = categoryLabels.en;
---

<Layout title={t('site.title')} description={t('site.description')}>
  <!-- Hero Section -->
  <section class="bg-gradient-to-br from-primary-500 to-secondary-500 text-white py-16 md:py-24">
    <div class="max-w-6xl mx-auto px-4 text-center">
      <h1 class="text-4xl md:text-5xl font-bold mb-4">
        {t('home.hero')}
      </h1>
      <p class="text-xl md:text-2xl opacity-90 mb-8">
        {t('home.heroSub')}
      </p>
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <a
          href="#tests"
          class="inline-block px-8 py-4 bg-white text-primary-600 font-bold rounded-full hover:bg-gray-100 transition-colors shadow-lg"
        >
          {t('home.startTest')}
        </a>
        <a
          href="#tools"
          class="inline-block px-8 py-4 bg-white/20 text-white font-bold rounded-full hover:bg-white/30 transition-colors border-2 border-white/50"
        >
          {t('tools.title')}
        </a>
      </div>
    </div>
  </section>

  <!-- Tests Section -->
  <section id="tests" class="py-16">
    <div class="max-w-6xl mx-auto px-4">
      <h2 class="text-3xl font-bold text-center mb-8 text-gray-900 dark:text-white">
        {t('home.allTests')}
      </h2>

      <!-- Category Filter -->
      <div class="flex flex-wrap justify-center gap-2 mb-8">
        <button
          data-category="all"
          class="category-btn px-4 py-2 rounded-full font-medium transition-all bg-primary-600 text-white"
        >
          {categories.all}
        </button>
        <button
          data-category="personality"
          class="category-btn px-4 py-2 rounded-full font-medium transition-all bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"
        >
          {categories.personality}
        </button>
        <button
          data-category="love"
          class="category-btn px-4 py-2 rounded-full font-medium transition-all bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"
        >
          {categories.love}
        </button>
        <button
          data-category="career"
          class="category-btn px-4 py-2 rounded-full font-medium transition-all bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"
        >
          {categories.career}
        </button>
        <button
          data-category="lifestyle"
          class="category-btn px-4 py-2 rounded-full font-medium transition-all bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"
        >
          {categories.lifestyle}
        </button>
        <button
          data-category="fun"
          class="category-btn px-4 py-2 rounded-full font-medium transition-all bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"
        >
          {categories.fun}
        </button>
      </div>

      <div id="test-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {tests.map((test) => (
          <div class="test-card" data-category={test.category}>
            <TestCard
              slug={test.slug}
              title={test.title}
              description={test.description}
              emoji={test.emoji}
              questionCount={test.questionCount}
              lang={lang}
            />
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- Tools Section -->
  <section id="tools" class="py-16 bg-gray-50 dark:bg-gray-800/50">
    <div class="max-w-6xl mx-auto px-4">
      <h2 class="text-3xl font-bold text-center mb-4 text-gray-900 dark:text-white">
        {t('tools.title')}
      </h2>
      <p class="text-center text-gray-600 dark:text-gray-400 mb-12">
        {t('tools.description')}
      </p>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {tools.map((tool) => (
          <ToolCard
            slug={tool.slug}
            title={tool.title}
            description={tool.description}
            emoji={tool.emoji}
            category={tool.category}
            lang={lang}
          />
        ))}
      </div>

      <div class="text-center mt-8">
        <a href={`/${lang}/tools`} class="text-primary-600 dark:text-primary-400 hover:underline font-medium">
          View All Tools â†’
        </a>
      </div>
    </div>
  </section>

  <!-- About Section -->
  <section class="py-16">
    <div class="max-w-4xl mx-auto px-4 text-center">
      <h2 class="text-3xl font-bold mb-6 text-gray-900 dark:text-white">
        About JudySylph
      </h2>
      <p class="text-gray-600 dark:text-gray-300 leading-relaxed">
        JudySylph provides fun and insightful psychological tests along with useful everyday tools.
        Discover your personality, love style, stress coping methods, and more.
        Use our convenient calculators and converters for your daily needs.
        All services are free, and you can share your results with friends.
      </p>
    </div>
  </section>
</Layout>

<script>
  // Category filter
  const categoryBtns = document.querySelectorAll('.category-btn');
  const testCards = document.querySelectorAll('.test-card');

  categoryBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      const category = btn.getAttribute('data-category');

      // Update button styles
      categoryBtns.forEach(b => {
        b.classList.remove('bg-primary-600', 'text-white');
        b.classList.add('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
      });
      btn.classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
      btn.classList.add('bg-primary-600', 'text-white');

      // Filter cards
      testCards.forEach(card => {
        if (category === 'all' || card.getAttribute('data-category') === category) {
          (card as HTMLElement).style.display = 'block';
        } else {
          (card as HTMLElement).style.display = 'none';
        }
      });

      // GA event
      if (typeof gtag !== 'undefined') {
        gtag('event', 'filter_category', {
          event_category: 'engagement',
          event_label: category
        });
      }
    });
  });
</script>
